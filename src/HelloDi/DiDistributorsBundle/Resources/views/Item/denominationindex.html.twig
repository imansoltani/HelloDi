{% extends 'HelloDiDiDistributorsBundle:Tabs:ShowItemMaster.html.twig' %}

{% set tab = '4' %}

{% block title %}
    {{ 'Items' | trans ({}, "item") }}
{% endblock title %}

{% block Site_Map %}
    <a class="link" href="{{ path('loginsuccess') }}">{{ 'Home' | trans ({}, "menu") }}</a>
    <a class="link" href="{{ path('item') }}">{{ 'Items' | trans ({}, "item") }}</a>
    <span class="link">{{ 'denomination' | trans ({}, "price") }}</span>
{% endblock Site_Map %}

{% set MU = 'item' %}

{% block Tab %}
    <div class="widget-header">
        <h3>{{ 'denomination' | trans ({}, "price") }}</h3>
    </div> <!-- /widget-header -->
    <br>
    <a class="btn btn-primary" onclick="Add_Row()">{{ 'Add' | trans ({}, "common") }}</a>

        <form method="post" {{ form_enctype(form) }} id="form_denomination">

                <table style="margin-top: 20px;max-width: 500px"
                       class="table table-bordered table-striped table-highlight postsend">
                    <thead>
                    <tr>
                        <th>{{ 'denomination' | trans ({}, "price") }}</th>
                        <th>{{ 'Currency' | trans ({}, "item") }}</th>
                    </tr>
                    </thead>
                    <tbody id="denomination_table">
                    {% for DenominationField in form.Denominations %}
                        <tr>
                            <td>
                                {{ form_widget(DenominationField.denomination,{ 'attr' : {'onkeydown' : 'return ( event.ctrlKey || event.altKey
                                    || (47<event.keyCode && event.keyCode<58 && event.shiftKey==false)
                                    || (95<event.keyCode && event.keyCode<106)
                                    || (event.keyCode==8) || (event.keyCode==9)
                                    || (event.keyCode>34 && event.keyCode<40)
                                    || (event.keyCode==46 || event.keyCode==116 || event.keyCode==190 || event.keyCode==110) )'} }) }}
                                {{ form_errors(DenominationField.denomination) }}
                            </td>
                            <td>
                                {{ form_widget(DenominationField.currency) }}
                                {{ form_errors(DenominationField.currency) }}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

            {{ form_rest(form) }}

            <div class="form-actions" style="margin-bottom: 0">
                <input type="submit" class="btn btn-primary" value="{{ 'Apply' | trans ({}, "common") }}" onclick="RemoveLastRowIfEmpty();$('#form_denomination').submit();"/>
            </div>

        </form>

    <script type="text/javascript">
        var denominationsCount = '{{ form.Denominations | length }}';

        function Add_Row() {
            if($('#form_Denominations_'+(denominationsCount-1)+'_denomination').val()!="" && $('#form_Denominations_'+(denominationsCount-1)+'_currency').val()!="")
            {
                $("#denomination_table").append(
                        '<tr>'+
                            '<td><div class="controls"><input class="input-large" id="form_Denominations_'+denominationsCount+'_denomination" name="form[Denominations]['+denominationsCount+'][denomination]" value="" type="text" onkeydown="return ( event.ctrlKey || event.altKey'+
                                '|| (47<event.keyCode && event.keyCode<58 && event.shiftKey==false)'+
                                '|| (95<event.keyCode && event.keyCode<106)'+
                                '|| (event.keyCode==8) || (event.keyCode==9)'+
                                '|| (event.keyCode>34 && event.keyCode<40)'+
                                '|| (event.keyCode==46 || event.keyCode==116 || event.keyCode==190 || event.keyCode==110) )" required="required" ></div></td>'+
                            '<td><div class="controls"><input class="input-large" id="form_Denominations_'+denominationsCount+'_currency" name="form[Denominations]['+denominationsCount+'][currency]" maxlength="3" required="required" type="text"></div></td>'+
                        '</tr>'
                );
                denominationsCount++;
            }
        }

        function RemoveLastRowIfEmpty() {
            if($('#form_Denominations_'+(denominationsCount-1)+'_denomination').val()=="" && $('#form_Denominations_'+(denominationsCount-1)+'_currency').val()=="")
            {
                $('#denomination_table').find('tr:last').remove();
            }
        }
    </script>

{% endblock %}
