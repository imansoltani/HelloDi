{% extends 'HelloDiDiDistributorsBundle:Menu:AdminRetailer.html.twig' %}

{% block title %}
    {{ 'IMTU' | trans ({}, "item") }}
{% endblock title %}

{% set MU = 'imtu' %}

{% block Site_Map %}
    <a class="link" href="{{ path('retailers_dashboard') }}">{{ 'Home' | trans ({}, "menu") }}  </a>
    <span class="link">{{ 'IMTU' | trans ({}, "item") }} </span>
{% endblock Site_Map %}

{% block PageTitle %}
    <i class="icon-mobile-phone"></i>
    {{ 'IMTU' | trans ({}, "item") }}
{% endblock %}

{% block Body %}
    <div class="span">
        <div class="widget stacked">

            <div class="widget-content">

                <form action="#" method="post" {{ form_enctype(form) }} class="form-horizontal">

                    <div class="control-group">
                        {{ form_label(form.receiverMobileNumber) }}
                        <div class="controls money">
                            {{ form_widget(form.receiverMobileNumber,{ 'attr' : {'onblur':'readNumber(this)'} }) }} <span class="icon-certificate"></span>
                        </div>
                        {{ form_errors(form.receiverMobileNumber) }}
                    </div>

                    <div class="hideForm wait">

                        <!-- widget-header -->
                        <div class="widget-header">
                            <h3>{{ 'Info' | trans ({}, "item") }}</h3>
                        </div>
                        <!-- /widget-header -->
                        <div class="control-group">
                            {{ form_label(form.denomination) }}
                            <div class="controls money">
                                {{ form_widget(form.denomination,{"id":"denomination"}) }} <span class="icon-certificate"></span>
                            </div>
                            {{ form_errors(form.denomination) }}
                        </div>

                        <div class="control-group">
                            {{ form_label(form.senderMobileNumber) }}
                            <div class="controls money">
                                {{ form_widget(form.senderMobileNumber,{ 'attr' : {'onkeydown' : 'return ( event.ctrlKey || event.altKey
                            || (47<event.keyCode && event.keyCode<58 && event.shiftKey==false)
                            || (95<event.keyCode && event.keyCode<106)
                            || (event.keyCode==8) || (event.keyCode==9)
                            || (event.keyCode>34 && event.keyCode<40)
                            || (event.keyCode==46) )'} }) }}
                            </div>
                            {{ form_errors(form.senderMobileNumber) }}
                        </div>

                        <div class="control-group">
                            {{ form_label(form.email) }}
                            <div class="controls money">
                                {{ form_widget(form.email) }}
                            </div>
                            {{ form_errors(form.email) }}
                        </div>

                        {{ form_widget(form._token) }}

                        <div class="form-actions" style="margin-bottom: 0">
                            <input type="submit" class="btn btn-primary" value="{{ 'Add' | trans ({}, "common") }}"/>
                        </div>

                        <div id="loading_div" class="FormLoader">
                            <div id="error_myform">Receiver mobile number is invalid.</div>
                        </div>

                    </div>

                </form>


            </div>
        </div>
    </div>

    <script type="text/javascript">
        function readNumber(input)
        {
            $("#error_myform").hide();
            $(".hideForm").removeClass("wait").addClass("load");
            var number = $(input).val();
            $.ajax({
                type: "Post",
                url: "{{ path("Retailer_Shop_Read_Number_imtu") }}",
                data: {"receiver":number},
                cache: false,
                success: function(result)
                {
                    $(".hideForm").removeClass("wait load");
                    if(result.length>0)
                        $("#denomination").html(result);
                    else
                    {
                        $(".hideForm").addClass("wait");
                        $("#error_myform").show();
                    }
                }
            });
        }
    </script>
{% endblock %}